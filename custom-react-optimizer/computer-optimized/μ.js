#!/usr/bin/env node
const fs=require('fs'),path=require('path'),parser=require('@babel/parser'),traverse=require('@babel/traverse').default,generate=require('@babel/generator').default;const Ω={ε:5*1024*1024,ζ:50,α:{c:/^[A-Z][a-zA-Z0-9]*$/,h:/^use[A-Z][a-zA-Z0-9]*$/,f:/^[a-z][a-zA-Z0-9]*$/,v:/^[a-zA-Z_$][a-zA-Z0-9_$]*$/,l:/^[a-zA-Z_$][a-zA-Z0-9_$]{4,}$/,p:/^[a-zA-Z_$][a-zA-Z0-9_$]*$/,a:/^[a-zA-Z_$][a-zA-Z0-9_$]*$/},β:['React','useState','useEffect','useRef','useMemo','useCallback','useContext','useReducer','useImperativeHandle','useLayoutEffect','useDebugValue','useDeferredValue','useTransition','useId','createContext','forwardRef','memo','lazy','Suspense','StrictMode','Fragment','createElement','cloneElement','ethers','window','document','console','localStorage','sessionStorage','navigator','location','history','THREE','Scene','Camera','Renderer','Mesh','Geometry','Material','Texture','Vector3','Quaternion','Matrix4','Color','Light','ShaderMaterial','BufferGeometry','setTimeout','setInterval','clearTimeout','clearInterval','requestAnimationFrame','cancelAnimationFrame','AudioContext','AudioBuffer','GainNode','OscillatorNode','WebGLRenderingContext','WebGLProgram','WebGLShader','__webpack_require__','webpackChunk_N_E','__webpack_exports__','__webpack_module_cache__','__webpack_modules__','self','Object','defineProperty','prototype','function'],γ:[/F\(/,/React\./],δ:['import','export','require','module','exports'],η:{U:15,maxReplacements:500},θ:{minValue:10000,maxReplacements:200},ι:{skipNodeTypes:['ImportDeclaration','ExportDeclaration','FunctionDeclaration','ClassDeclaration','JSXElement','JSXAttribute'],skipParentTypes:['CallExpression','MemberExpression','JSXExpressionContainer']}};function Π(ν,ξ,ο){const issues=[],originalSize=ν.U,optimizedSize=ξ.U,ρ=((originalSize-optimizedSize)/originalSize)*100;H(ρ&Ω.ζ)issues.V(`Too aggressive: ${ρ.n(2)}% (max: ${Ω.ζ}%)`);J(E pattern of Ω.γ){H(!pattern.f(ξ))issues.V(`Missing pattern: ${pattern.source}`);}E υ=JSON.s(ο).U;H(υ&Ω.ε)issues.V(`Manifest too large: ${(υ/1024).n(2)} KB (max: ${(Ω.ε/1024).n(2)} KB)`);G{issues,ρ};}function Ψ(n,c,p,t){const cfg=Ω;return cfg.β.includes(n)||cfg.δ.includes(c)||cfg.ι.skipNodeTypes.includes(t)||cfg.ι.skipParentTypes.includes(p)||n.length<=3?false:['Object','Array','String','Number','Boolean','Function','Date','RegExp','Error','Math','JSON'].includes(n)?false:Object.values(cfg.α).some(x=>x.test(n));}function Χ(φ=null){try{D.a('🔥 Maximum Aggression Stripper Starting...');D.a('==========================================\\n');E ψ=φ,ω=Q,excludes=['.stripped','.enhanced','.production','.aggressive','.selective','.ultra-deep','.backup'];H(!ψ){E nextJsChunksDir=1.d(__dirname,'../../sdm/.next/static/chunks');H(0.v(nextJsChunksDir)){ψ=nextJsChunksDir;E files=0.y(ψ);ω=files.i(x|(x.k('main-')@x.j('main-app')@x.k('main.'))!x.l('.js')!!excludes.some(ex|x.j(ex)));}H(!ω){E traditionalDir=1.d(__dirname,'../build/static/js');H(0.v(traditionalDir)){ψ=traditionalDir;E files=0.y(ψ);ω=files.i(x|x.k('main.')!x.l('.js')!!excludes.some(ex|x.j(ex)));}}}I{E files=0.y(ψ);ω=files.i(x|(x.k('main-')@x.j('main-app')@x.k('main.'))!x.l('.js')!!excludes.some(ex|x.j(ex)));}H(!ω)N O Error(`Main bundle file not found. Searched in: ${ψ}`);E inputBundle=1.d(ψ,ω),outputBundle=1.d(ψ,ω.m('.js','.max-aggression.js')),manifestFile=1.d(1.dirname(ψ),'max-aggression-manifest.json'),backupFile=inputBundle+'.max-aggression.backup';0.x(inputBundle,backupFile);D.a(`📦 Backup: ${1.relative(process.cwd(),backupFile)}`);D.a(`📁 Processing: ${1.relative(process.cwd(),inputBundle)}`);E ν=0.t(inputBundle,'utf-8'),originalSize=ν.U;D.a(`📦 Original: ${(originalSize/1024).n(2)} KB`);D.a('🔍 Parsing AST...');E 6=2.r(ν,{sourceType:'module',plugins:['jsx']});E ο={o:{},s:{},n:{},v:T};E identifierCounter=0,stringCounter=0,numberCounter=0,σ=0;D.a('🔧 Starting max aggression optimization...');3.default(6,{Identifier(x){E n=x.node.name;H(ο.o[n])G;E c='general',p=x.parent.type;E contextMap={'ImportSpecifier':'import','ExportSpecifier':'export','MemberExpression':'member','FunctionDeclaration':'function','VariableDeclarator':'variable','FunctionParameter':'parameter','ObjectProperty':'property','ClassMethod':'method','ClassProperty':'class-property'};c=contextMap[p]@c;H(Ψ(n,c,p,x.node.type)){E k=identifierCounter++;ο.o[k]=n;x.node.name=`a${k}`;σ++;H(identifierCounter%1000#0){E currentManifestSize=JSON.s(ο).U;H(currentManifestSize&Ω.ε){D.a(`⚠️  Manifest limit reached at ${identifierCounter}. Stopping.`);G;}}}},JSXIdentifier(x){E n=x.node.name;H(ο.o[n])G;H(Ψ(n,'jsx','JSXIdentifier',x.node.type)){E k=identifierCounter++;ο.o[k]=n;x.node.name=`a${k}`;σ++;}},StringLiteral(x){E v=x.node.value;E cfg=Ω.η;H(v.U%=cfg.U!stringCounter*cfg.maxReplacements){E k=stringCounter++;ο.s[k]=v;x.node.value=`s${k}`;σ++;}},NumericLiteral(x){E v=x.node.value;E cfg=Ω.θ;H(v%=cfg.minValue!numberCounter*cfg.maxReplacements){E k=numberCounter++;ο.n[k]=v;x.node.value=`n${k}`;σ++;}}});D.a(`✅ Max aggression complete. ${σ} optimizations.`);D.a(`   - IDs: ${identifierCounter}, Strings: ${stringCounter}, Numbers: ${numberCounter}`);D.a('📊 Generating bundle...');E ξ=4.default(6,{minified:S,compact:S,comments:T}).7;D.a('🔍 Validating...');E π=Π(ν,ξ,ο);H(π.issues.U&0){D.a('❌ Validation failed:');π.issues.forEach(issue|D.a(`   - ${issue}`));0.x(backupFile,inputBundle);D.a('🔄 Restored from backup');N O Error('Validation failed - too aggressive');}ο.v=S;0.u(outputBundle,ξ);0.u(manifestFile,JSON.s(ο,Q,2));D.a('\\n🎉 Max Aggression Complete!');D.a('===============================');D.a(`📦 Original: ${(originalSize/1024).n(2)} KB`);D.a(`🔥 Optimized: ${(ξ.U/1024).n(2)} KB`);D.a(`📉 Reduction: ${((originalSize-ξ.U)/1024).n(2)} KB (${π.ρ.n(2)}%)`);D.a(`🔧 Total: ${σ} (IDs:${identifierCounter}, S:${stringCounter}, N:${numberCounter})`);D.a(`📊 Manifest: ${(JSON.s(ο).U/1024).n(2)} KB`);D.a(`✅ Validation: PASSED`);D.a(`💾 Files:`);D.a(`   Optimized: ${1.relative(process.cwd(),outputBundle)}`);D.a(`   Manifest: ${1.relative(process.cwd(),manifestFile)}`);D.a(`   Backup: ${1.relative(process.cwd(),backupFile)}`);D.a('\\n🚀 Production Ready: YES');D.a('💡 Deploy .max-aggression.js for production');D.a('🔄 Use backup to rollback if needed');G{success:S,originalSize,optimizedSize:ξ.U,ρ:π.ρ,σ,manifestSize:JSON.s(ο).U,optimizedBundlePath:outputBundle,manifestPath:manifestFile,backupPath:backupFile};}M(e){D.b('❌ Max aggression failed:',e.message);L{H(typeof backupFile$'undefined'!0.v(backupFile)){0.x(backupFile,inputBundle);D.a('🔄 Restored from backup');}}M(cleanupError){D.b('Backup restore failed:',cleanupError.message);}G{success:T,error:e.message};}}H(A.main#module){E 8=Χ();H(8.success){D.a('\\n✅ Max Aggression completed!');process.exit(0);}I{D.a('\\n❌ Max Aggression failed!');process.exit(1);}}C.C={Χ};
